name: CI Basic

on:
  pull_request:
    branches: [ main ]
  push:
    branches: [ main ]

jobs:
  php-lint:
    name: PHP Lint
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Set up PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.0'
      - name: Lint PHP files
        run: |
          files=$(git ls-files '*.php') || true
          if [ -n "$files" ]; then
            echo "$files" | xargs -n1 php -l || exit 1
          fi

  smoke-tests:
    name: Smoke Tests (php)
    runs-on: ubuntu-latest
    needs: php-lint
    steps:
      - uses: actions/checkout@v4
      - name: Run smoke-tests script
        run: |
          php -v
          if [ -f scripts/smoke-tests.ps1 ]; then
            echo "Smoke tests present (PowerShell). Skipping PS execution on Linux runner.";
          fi
          # Placeholder for platform-appropriate smoke tests; user can extend to run WP-CLI setup in CI.
          echo "CI smoke-check passed."
